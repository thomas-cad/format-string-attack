\section{Extraction d'informations via GDB}

% --- Slide 1 : Session GDB ---
\begin{frame}[fragile]{Session de débogage}
    \textbf{Injection :} \code{AAAAAAAA \%7\$p \%27\$p} pour inspecter la pile

    \begin{lstlisting}[language=bash]
(gdb) run
Please Insert an IP address to ping:
AAAAAAAA %7$p %27$p
AAAAAAAA 0x7fffffffdc38 0x5555555554f3
    \end{lstlisting}

    \vspace{0.3cm}
    \textbf{Rappel convention x86\_64 :}
    \begin{itemize}
        \item 6 premiers arguments dans les registres (RDI, RSI, RDX, RCX, R8, R9)
        \item \code{\%7\$p} = premier mot sur la pile (au-delà des registres)
    \end{itemize}
\end{frame}

% --- Slide 2 : Analyse des mots exfiltrés ---
\begin{frame}{Analyse des données exfiltrées}
    \begin{columns}[T]
        \begin{column}{0.48\textwidth}
            \textbf{Mot n\textsuperscript{o}7 : \texttt{0x7fff...dc38}}
            \begin{itemize}
                \item Adresse de la \textbf{pile} (stack)
                \item Pointeur vers une variable locale ou le buffer
                \item Cible d'écriture avec \code{\%7\$n}
            \end{itemize}
        \end{column}
        \begin{column}{0.48\textwidth}
            \textbf{Mot n\textsuperscript{o}27 : \texttt{0x5555...54f3}}
            \begin{itemize}
                \item Adresse du segment \textbf{.text} (PIE)
                \item = \textbf{Saved RIP} (adresse de retour)
                \item Preuve : $\texttt{0x54f3} - 5 = \texttt{0x54ee}$ (instruction \texttt{call})
            \end{itemize}
        \end{column}
    \end{columns}
\end{frame}

% --- Slide 3 : Stack mapping ---
\begin{frame}{Cartographie de la pile}
    \begin{table}
        \centering
        \small
        \begin{tabular}{|c|c|l|}
            \hline
            \textbf{Offset} & \textbf{Contenu} & \textbf{Description} \\
            \hline
            \code{\%7\$p}  & \texttt{0x7fff...dc38} & Sommet de pile (RSP) \\
            \hline
            \code{\%8\$p} -- \code{\%26\$p} & \dots & Variables locales + padding \\
            \hline
            \textbf{\code{\%27\$p}} & \texttt{0x5555...54f3} & \textbf{Saved RIP} (retour vers main) \\
            \hline
            \code{\%28\$p} & \dots & Zone stable (stockage "/bin/sh") \\
            \hline
        \end{tabular}
    \end{table}

    \vspace{0.3cm}
    \textbf{Conclusion :} distance Saved RIP -- sommet pile = $20 \times 8 = 160$ octets
\end{frame}
